
<ion-content>
  <form #form="ngForm" (ngSubmit)="ActionSaveActivity(form)">
  <ion-toolbar class="poss">
    <ion-title class="titleheader">Activity Details</ion-title>
    <ion-button slot="end" color="success" size="small" type="submit">Save</ion-button>
    <ion-button slot="end" color="danger" size="small" (click)="ActionCloseActivity(false)">X</ion-button>
  </ion-toolbar>
 
    <ion-item *ngIf="actinfo.ID == 0">
      <ion-label class="labelfont margin-top" position="floating" color="primary">Job# & Name<span class="requiredField">*</span>
      </ion-label>
      <ion-input [(ngModel)]="actinfo.JobName" name="JobName" type="text"  #nameField="ngModel" 
        (keyup.enter)="ActionApprovedJobList(actinfo.JobName,1)" required></ion-input>
      <ion-icon slot="end" class="marg2"   name="arrow-dropdown"
        (click)="ActionApprovedJobList('',2)"></ion-icon>
      <ion-icon slot="end" class="marg2"  name="search" 
        (click)="ActionApprovedJobList(actinfo.JobName,1)"></ion-icon>
    </ion-item>
    <div [hidden]="!form.submitted  || nameField.valid" class="invalid-feedback padd-Left">
      <div class="error">Select Job</div>
    </div>
    <ion-item *ngIf="actinfo.ID > 0">
      <ion-label>
        <h2>{{actinfo.QuoteNo}} - {{actinfo.JobName}} -
          P{{actinfo.PhaseSrNo}}</h2>
        <h3>{{actinfo.SalesPerName}}</h3>
        <p>
          {{actinfo.JobFullAddres}}
        </p>
      </ion-label>
    </ion-item>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">Activity Phase:</ion-label>
      <ion-select (ionChange)="ActionChangePhase()" [(ngModel)]="actinfo.PhaseID" name="PhaseID"  #nameField="ngModel"  required>
        <ion-select-option *ngFor="let c of phaseList" [value]="c.ID">{{c.Name}}</ion-select-option>
      </ion-select>
    </ion-item>
    <div [hidden]="!form.submitted  || nameField.valid" class="invalid-feedback padd-Left">
      <div class="error">Activity Phase is required</div>
    </div>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">Activity Type:</ion-label>
      <ion-select [(ngModel)]="actinfo.ActTypeID" name="ActTypeID" 
      #nameField="ngModel"  (ionChange)="ActionGetStatusResourceList(actinfo.ActTypeID)" required>
        <ion-select-option *ngFor="let c of ActTypeList" [value]="c.ID">{{c.Name}}</ion-select-option>
      </ion-select>
    </ion-item>
    <div [hidden]="!form.submitted  || nameField.valid" class="invalid-feedback padd-Left">
      <div class="error">Activity Type is required</div>
    </div>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">Areas:</ion-label>
      <ion-select [(ngModel)]="actinfo.itemSelected" name="itemSelected" 
        #itemSelected="ngModel">
        <ion-select-option *ngFor="let part of AreaList" [value]="part.ID">{{part.AreaName}} - Part{{part.NewSrNo}} - {{part.JobSqft}} SF
        </ion-select-option>
      </ion-select>
    </ion-item>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">Activity Status:</ion-label>
      <ion-select [(ngModel)]="actinfo.StatusID" name="StatusID" 
        #StatusID="ngModel">
        <ion-select-option *ngFor="let c of statusList" [value]="c.ID">{{c.Name}}</ion-select-option>
      </ion-select>
    </ion-item>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">Start Date & Time:</ion-label>
      <ion-row style="width:100%">
        <ion-col size="10">
          <ion-datetime displayFormat="MM/DD/YYYY HH:mm" pickerFormat="MMM D:HH:mm"(ngModelChange)="ActionChangeDate($event,0,'sDate')" name="StartDate" [(ngModel)]="actinfo.SchStartTime">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
        <!-- <ion-col size="6">
          <ion-datetime  pickerFormat="h:mm A" name="StartTime" [(ngModel)]="actinfo.StartTime"></ion-datetime>
          <span class="select-icon ion-float-right"></span>
        </ion-col> -->
      </ion-row>
    </ion-item>
    <ion-item>
      <ion-label position="floating" color="primary" class="margin-zero">End Date & Time:</ion-label>
      <ion-row style="width:100%">
        <ion-col size="10">
          <ion-datetime displayFormat="MM/DD/YYYY HH:mm" pickerFormat="MMM D:HH:mm" (ngModelChange)="ActionChangeDate($event,1,'eDate')" name="EndDate" [(ngModel)]="actinfo.SchEndTime">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
        <!-- <ion-col size="6">
          <ion-datetime displayFormat="h:mm a" pickerFormat="h:mm A" name="EndTime" [(ngModel)]="actinfo.EndTime">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col> -->
      </ion-row>
    </ion-item>

    <ion-item *ngIf="actinfo.StatusID ==5">
      <ion-label position="floating" color="primary" class="margin-zero">Act Start Date & Time:</ion-label>
      <ion-row style="width:100%">
        <ion-col size="6" style="border-right: 1px solid #ddd;">
          <ion-datetime displayFormat="MM/DD/YYYY" pickerFormat="MM/DD/YYYY" name="ActStartDate" [(ngModel)]="actinfo.ActualStartDate">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
        <ion-col size="6">
          <ion-datetime displayFormat="h:mm a" pickerFormat="h:mm A" name="ActStartTime" [(ngModel)]="actinfo.ActualStartDate">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
      </ion-row>
    </ion-item>
    <ion-item *ngIf="actinfo.StatusID ==5">
      <ion-label position="floating" color="primary" class="margin-zero">Act End Date & Time:</ion-label>
      <ion-row style="width:100%">
        <ion-col size="6" style="border-right: 1px solid #ddd;">
          <ion-datetime displayFormat="MM/DD/YYYY" pickerFormat="MM/DD/YYYY" name="ActEndDate" [(ngModel)]="actinfo.ActualEndDate">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
        <ion-col size="6">
          <ion-datetime displayFormat="h:mm a" pickerFormat="h:mm A" name="ActEndTime" [(ngModel)]="actinfo.ActualEndDate">
          </ion-datetime><span class="select-icon ion-float-right"></span>
        </ion-col>
      </ion-row>
    </ion-item>
    <ion-row>
      <ion-label class="margin-zero notestyle" color="primary"><u>Note:</u></ion-label>
    </ion-row>
    <ion-row class="padding5">
      <ion-textarea rows="4" cols="6" name="Memo" class="borderall"></ion-textarea>
    </ion-row>
    <ion-item>
      <ion-list>
      <ion-row>
      <ion-label color="primary" class="margin-zero">Resources:
        </ion-label>
      </ion-row>
      <ion-row>
        <ion-col size="8">
          Name
        </ion-col>
        <ion-col size="2">
          Email
        </ion-col>
        <ion-col size="2">
          Text
        </ion-col>
      </ion-row>
      <ion-row  *ngFor="let resource of actinfo.ResourceList">
        <ion-col size="8">
          {{resource.ResourceName}}
          <small>{{resource.EmpMail}}</small>
        </ion-col>
        <ion-col size="2">
          <ion-checkbox style="width:30px" color="dark" name="Email"  [(ngModel)]="resource.Email" checked="resource.Email ==1"></ion-checkbox> 
        </ion-col>
        <ion-col size="2">
          <ion-checkbox style="width:30px" color="dark" name="Text" [(ngModel)]="resource.Text" checked="resource.Text ==1"></ion-checkbox> 
        </ion-col>
      </ion-row>
    </ion-list>
    </ion-item>
    

  </form>
</ion-content>